# amplify-admin

## Installation

Install the application dependencies by running:

```sh
npm install
```

## Development

Start the application in development mode by running:

```sh
npm run dev
```

## Production

Build the application in production mode by running:

```sh
npm run build
```

## API Gateway/Lambda Integration

This project includes a simple API Gateway/Lambda integration for testing purposes:

1. A Lambda function that returns a "Hello World" response
2. API Gateway integration with the Lambda function
3. A frontend page to test the API

### Deploying the Backend

To deploy the Amplify backend:

```sh
npx amplify sandbox
```

This will create a temporary deployment of your backend resources. Note the API Gateway URL from the output.

For a permanent deployment:

```sh
npx amplify deploy
```

### Configuring the Frontend

The frontend application uses the `amplify_outputs.json` file to get the API endpoint. This file is automatically generated when you deploy your backend using Amplify CLI.

The `amplify_outputs.json` file contains the outputs from your CloudFormation stacks, including the API endpoint. Using this file ensures that your frontend is always pointing to the correct API endpoint without requiring manual updates.

No manual configuration is needed for the API endpoint as it's automatically updated when you deploy your backend.

### Testing the API

1. Start the development server: `npm run dev`
2. Navigate to the application in your browser
3. Click on the "API Test" menu item in the sidebar
4. Click the "Call API" button to test the Lambda function

## Infrastructure Configuration

The application uses a VPC, subnets, and security groups for the Lambda function. These values are configured through environment variables.

### Configuration Files

- `.env`: Contains placeholder values for infrastructure configuration (used in development and as fallbacks)
- `.env.local`: Contains actual infrastructure values (not committed to the repository)

### Environment Variables

To update the infrastructure configuration, modify the following environment variables in `.env.local`:

- `VPC_ID`: The ID of your VPC
- `VPC_AVAILABILITY_ZONES`: Comma-separated list of availability zones
- `SUBNET_IDS`: Comma-separated list of subnet IDs
- `SECURITY_GROUP_ID`: The ID of your security group
- `SECURITY_GROUP_ALLOW_OUTBOUND`: Whether to allow outbound traffic (true/false)

Example configuration in `.env.local`:

```
# Infrastructure Configuration
# VPC Configuration
VPC_ID=vpc-8a466af2
VPC_AVAILABILITY_ZONES=us-west-2a,us-west-2b

# Subnet Configuration
SUBNET_IDS=subnet-069cf551df95c5e50,subnet-02d9a610953b19d14

# Security Group Configuration
SECURITY_GROUP_ID=sg-3f2e7602
SECURITY_GROUP_ALLOW_OUTBOUND=true
```

### Running with Environment Variables

To run the sandbox with environment variables loaded from `.env.local`, use the following command:

```sh
npx dotenvx run --env-file=.env.local -- npx ampx sandbox
```

This will load the environment variables from `.env.local` and make them available to the sandbox. The `amplify/backend.ts` file reads these environment variables and falls back to default values if they are not set.
